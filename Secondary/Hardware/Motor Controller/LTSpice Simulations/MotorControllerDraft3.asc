Version 4
SHEET 1 3412 2700
WIRE 1472 16 1296 16
WIRE 1600 16 1552 16
WIRE 1712 16 1600 16
WIRE 432 32 64 32
WIRE 848 32 432 32
WIRE 432 64 432 32
WIRE 848 64 848 32
WIRE 1600 96 1600 16
WIRE 1712 96 1712 16
WIRE 64 144 64 32
WIRE 288 144 272 144
WIRE 384 144 368 144
WIRE 704 144 688 144
WIRE 800 144 784 144
WIRE 432 192 432 160
WIRE 512 192 432 192
WIRE 848 192 848 160
WIRE 928 192 848 192
WIRE 432 224 432 192
WIRE 848 224 848 192
WIRE 1600 256 1600 160
WIRE 1600 256 1296 256
WIRE 1712 256 1712 176
WIRE 1712 256 1600 256
WIRE 288 304 272 304
WIRE 384 304 368 304
WIRE 704 304 688 304
WIRE 800 304 784 304
WIRE 64 368 64 224
WIRE 432 368 432 320
WIRE 432 368 64 368
WIRE 848 368 848 320
WIRE 848 368 432 368
WIRE 432 384 432 368
WIRE -144 720 -160 720
WIRE -32 720 -144 720
WIRE 64 720 32 720
WIRE 112 720 64 720
WIRE 320 720 176 720
WIRE 480 720 464 720
WIRE 592 720 480 720
WIRE 688 720 656 720
WIRE 736 720 688 720
WIRE 944 720 800 720
WIRE 64 768 64 720
WIRE 688 768 688 720
WIRE -144 832 -144 720
WIRE -64 832 -144 832
WIRE 208 832 192 832
WIRE 480 832 480 720
WIRE 560 832 480 832
WIRE 832 832 816 832
WIRE -64 912 -176 912
WIRE 320 912 320 720
WIRE 320 912 192 912
WIRE 352 912 320 912
WIRE 560 912 448 912
WIRE 944 912 944 720
WIRE 944 912 816 912
WIRE 976 912 944 912
WIRE -64 928 -64 912
WIRE -176 992 -176 912
WIRE -160 992 -176 992
WIRE -80 992 -96 992
WIRE -64 992 -80 992
WIRE 208 992 192 992
WIRE 448 992 448 912
WIRE 464 992 448 992
WIRE 544 992 528 992
WIRE 560 992 544 992
WIRE 832 992 816 992
WIRE -80 1008 -80 992
WIRE 544 1008 544 992
WIRE -176 1024 -176 992
WIRE 448 1024 448 992
WIRE 64 1072 64 1056
WIRE 688 1072 688 1056
WIRE -656 1552 -656 1520
WIRE -416 1584 -560 1584
WIRE -560 1648 -560 1584
WIRE -544 1648 -560 1648
WIRE -416 1664 -416 1584
WIRE -416 1664 -480 1664
WIRE -352 1664 -416 1664
WIRE -656 1680 -656 1632
WIRE -544 1680 -656 1680
WIRE -656 1760 -656 1680
WIRE -656 1872 -656 1840
FLAG 272 144 drive1H
FLAG 272 304 drive1L
FLAG 688 144 drive2H
FLAG 688 304 drive2L
FLAG 208 832 drive1H
FLAG 208 992 drive1L
FLAG 832 832 drive2H
FLAG 832 992 drive2L
FLAG 352 912 Vleft
FLAG 432 384 0
FLAG 64 1072 0
FLAG 688 1072 0
FLAG 976 912 Vright
FLAG -1168 752 drive1pwm
FLAG -1168 1008 drive2pwm
FLAG -1168 832 0
FLAG -1168 1088 0
FLAG -176 1024 drive1pwm
FLAG 448 1024 drive2pwm
FLAG -880 464 0
FLAG -880 384 Vcc
FLAG -160 720 Vcc
FLAG 464 720 Vcc
FLAG 512 192 Vleft
FLAG 928 192 Vright
FLAG -976 1632 0
FLAG -976 1552 5V
FLAG -656 1520 5V
FLAG -656 1872 0
FLAG -512 1632 5V
FLAG -512 1696 0
FLAG -352 1664 2V5
FLAG 1296 16 Vleft
FLAG 1296 256 Vright
FLAG 64 32 Vin
SYMBOL voltage 64 128 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vin
SYMATTR Value 10V
SYMBOL nmos 384 64 R0
SYMATTR InstName M1
SYMATTR Value Si7336ADP
SYMBOL nmos 384 224 R0
SYMATTR InstName M2
SYMATTR Value Si7336ADP
SYMBOL nmos 800 64 R0
SYMATTR InstName M3
SYMATTR Value Si7336ADP
SYMBOL nmos 800 224 R0
SYMATTR InstName M4
SYMATTR Value Si7336ADP
SYMBOL PowerProducts\\LTC4444 64 912 R0
SYMATTR InstName U1
SYMBOL PowerProducts\\LTC4444 688 912 R0
SYMATTR InstName U2
SYMBOL cap 176 704 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 1µF
SYMBOL diode -32 736 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N914
SYMBOL diode 592 736 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value 1N914
SYMBOL cap 800 704 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 1µF
SYMBOL Digital\\inv -160 928 R0
SYMATTR InstName A1
SYMATTR SpiceLine Vhigh=5V,Td=5e-9,Trise=20e-9
SYMBOL Digital\\inv 464 928 R0
SYMATTR InstName A2
SYMATTR SpiceLine Vhigh=5V,Td=5e-9,Trise=20e-9
SYMBOL voltage -1168 736 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName drive1pwm
SYMATTR Value PULSE(0 5 0 10n 10n {positive_dutycycle*period} {period})
SYMBOL voltage -1168 992 R0
WINDOW 3 25 90 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 5 {theta} 10n 10n {negative_dutycycle*period} {period})
SYMATTR InstName drive2pwm
SYMBOL voltage -880 368 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vcc
SYMATTR Value 12V
SYMBOL res 384 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 5
SYMBOL res 384 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 5
SYMBOL res 800 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 5
SYMBOL res 800 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 5
SYMBOL voltage -976 1536 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL OpAmps\\UniversalOpamp2 -512 1664 R0
SYMATTR InstName U3
SYMBOL res -672 1536 R0
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL res -672 1744 R0
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL ind 1456 32 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 10µ
SYMBOL cap 1584 96 R0
SYMATTR InstName C6
SYMATTR Value 10µ
SYMBOL res 1696 80 R0
SYMATTR InstName R10
SYMATTR Value 50
TEXT -144 616 Left 3 ;Bootstrap Drivers
TEXT 72 -48 Left 3 ;MOSFET Full-bridge inverter
TEXT -216 184 Left 2 ;4V <= Vin <= 10V
TEXT -1096 152 Left 2 !.tran 4m
TEXT -1176 1240 Left 2 !.param theta = 5u
TEXT -1176 1168 Left 2 !.param positive_dutycycle=0 negative_dutycycle=0.5
TEXT -1176 1304 Left 2 ;Change params positive_dutycycle and negative_dutycycle \nas needed to simulate pwm signal
TEXT -1184 1472 Left 2 ;5V power supply for microcontroller
TEXT -720 1464 Left 2 ;2.5V offset for voltage sensing
TEXT 1208 -48 Left 2 ;Driving the motor
TEXT 1704 -8 Left 2 ;Motor
TEXT 1376 296 Left 2 ;Note that L, R, and C are arbitrary values.
TEXT -920 1240 Left 2 !.param period=5u
TEXT -1200 288 Left 2 ;Power supply for bootstrap drivers and differential amplifier.
TEXT -184 -176 Left 2 ;Measure voltage, current and therefore power. Use this to control speed
TEXT -120 -128 Left 2 ;Could do PI controller at the input, perhaps to ensure the power going into the motor? \nIf voltage drops, increase current, etc.
TEXT 712 -176 Left 2 ;Goal is to have highest acceleration - draw as much power as possible from input.\nAnother is the speed control, to stay at a constant speed.
TEXT 160 616 Left 2 ;Using MIC4605
LINE Normal -288 1936 -288 1456 2
LINE Normal -736 1936 -288 1936 2
LINE Normal -752 1936 -736 1936 2
LINE Normal -752 1456 -752 1936 2
LINE Normal -752 1424 -752 1456 2
LINE Normal -288 1424 -752 1424 2
LINE Normal -288 1472 -288 1424 2
RECTANGLE Normal -272 -80 1088 480 2
RECTANGLE Normal 1168 1200 -240 592 2
RECTANGLE Normal -784 1696 -1216 1424 2
RECTANGLE Normal 1792 208 1440 -32 2
RECTANGLE Normal 1888 352 1184 -80 2
RECTANGLE Normal -320 1376 -1216 608 2
RECTANGLE Normal -448 528 -1216 240 2
